<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
	<style>	
	*{margin:0;padding:0;list-style: none;}
	body,html{background:#efefef;height:100%;overflow: hidden;}
	.wrap{width:800px;margin:80px auto;height:400px;position: relative;transform-style:preserve-3d;}
	.wrap li{float:left;margin:0 10px 10px 0;opacity: 1;box-shadow: 0 10px 15px rgba(0,0,0,.5);width:190px;height:190px;}
	.wrap li a{background:url(https://raw.githubusercontent.com/zaiYe/learngit/master/image/bg_thumb.jpg) no-repeat center;display: inline-block;}
	.wrap li img{display: block;opacity: .8;-webkit-filter:brightness(.5);-webkit-transition:all .5s;transition:all .5s;width:100%;}
	.wrap li:hover img{opacity: 1;-webkit-filter:brightness(1);}
	.btn_group{width:40px;position:absolute;right:-60px;top:40%;}
	.btn_group a{float:left;width:40px;height:25px;background:url(https://raw.githubusercontent.com/zaiYe/learngit/master/image/page.png) no-repeat;opacity: .7;margin-bottom: 20px;}
	.btn_group a:hover{opacity: 1;}
	#down{background-position:0 -25px;}
	.cur{-webkit-transition:all .5s;-moz-transition:all .5s;transition:all .5s;}
	</style>
</head>
<body>
	<div class="wrap" id="wrap">
		<ul>
			<li>
				<a href="#">
					<img src="https://raw.githubusercontent.com/zaiYe/learngit/master/image/03.jpg" alt="">
				</a>
			</li>
			<li>
				<a href="#">
					<img src="https://raw.githubusercontent.com/zaiYe/learngit/master/image/08.jpg" alt="">
				</a>
			</li>
			<li>
				<a href="#">
					<img src="https://raw.githubusercontent.com/zaiYe/learngit/master/image/03.jpg" alt="">
				</a>
			</li>
			<li>
				<a href="#">
					<img src="https://raw.githubusercontent.com/zaiYe/learngit/master/image/08.jpg" alt="">
				</a>
			</li>
			<li>
				<a href="#">
					<img src="https://raw.githubusercontent.com/zaiYe/learngit/master/image/03.jpg" alt="">
				</a>
			</li>
			<li>
				<a href="#">
					<img src="https://raw.githubusercontent.com/zaiYe/learngit/master/image/08.jpg" alt="">
				</a>
			</li>
			<li>
				<a href="#">
					<img src="https://raw.githubusercontent.com/zaiYe/learngit/master/image/03.jpg" alt="">
				</a>
			</li>
			<li>
				<a href="#">
					<img src="https://raw.githubusercontent.com/zaiYe/learngit/master/image/08.jpg" alt="">
				</a>
			</li>
			<li>
				<a href="#">
					<img src="https://raw.githubusercontent.com/zaiYe/learngit/master/image/03.jpg" alt="">
				</a>
			</li>
			<li>
				<a href="#">
					<img src="https://raw.githubusercontent.com/zaiYe/learngit/master/image/08.jpg" alt="">
				</a>
			</li>
			<li>
				<a href="#">
					<img src="https://raw.githubusercontent.com/zaiYe/learngit/master/image/03.jpg" alt="">
				</a>
			</li>
			<li>
				<a href="#">
					<img src="https://raw.githubusercontent.com/zaiYe/learngit/master/image/08.jpg" alt="">
				</a>
			</li>
			<li>
				<a href="#">
					<img src="https://raw.githubusercontent.com/zaiYe/learngit/master/image/03.jpg" alt="">
				</a>
			</li>
			<li>
				<a href="#">
					<img src="https://raw.githubusercontent.com/zaiYe/learngit/master/image/08.jpg" alt="">
				</a>
			</li>
			<li>
				<a href="#">
					<img src="https://raw.githubusercontent.com/zaiYe/learngit/master/image/03.jpg" alt="">
				</a>
			</li>
			<li>
				<a href="#">
					<img src="https://raw.githubusercontent.com/zaiYe/learngit/master/image/08.jpg" alt="">
				</a>
			</li>
			<li>
				<a href="#">
					<img src="https://raw.githubusercontent.com/zaiYe/learngit/master/image/03.jpg" alt="">
				</a>
			</li>
			<li>
				<a href="#">
					<img src="https://raw.githubusercontent.com/zaiYe/learngit/master/image/08.jpg" alt="">
				</a>
			</li>
			<li>
				<a href="#">
					<img src="https://raw.githubusercontent.com/zaiYe/learngit/master/image/03.jpg" alt="">
				</a>
			</li>
			<li>
				<a href="#">
					<img src="https://raw.githubusercontent.com/zaiYe/learngit/master/image/08.jpg" alt="">
				</a>
			</li>
			<li>
				<a href="#">
					<img src="https://raw.githubusercontent.com/zaiYe/learngit/master/image/03.jpg" alt="">
				</a>
			</li>
			<li>
				<a href="#">
					<img src="https://raw.githubusercontent.com/zaiYe/learngit/master/image/08.jpg" alt="">
				</a>
			</li>
			<li>
				<a href="#">
					<img src="https://raw.githubusercontent.com/zaiYe/learngit/master/image/03.jpg" alt="">
				</a>
			</li>
			<li>
				<a href="#">
					<img src="https://raw.githubusercontent.com/zaiYe/learngit/master/image/08.jpg" alt="">
				</a>
			</li>
			<li>
				<a href="#">
					<img src="https://raw.githubusercontent.com/zaiYe/learngit/master/image/03.jpg" alt="">
				</a>
			</li>
			<li>
				<a href="#">
					<img src="https://raw.githubusercontent.com/zaiYe/learngit/master/image/08.jpg" alt="">
				</a>
			</li>
			<li>
				<a href="#">
					<img src="https://raw.githubusercontent.com/zaiYe/learngit/master/image/03.jpg" alt="">
				</a>
			</li>
			<li>
				<a href="#">
					<img src="https://raw.githubusercontent.com/zaiYe/learngit/master/image/08.jpg" alt="">
				</a>
			</li>
		</ul>
		<div class="btn_group">
			<a href="#" id='up'></a>
			<a href="#" id='down'></a>
	</div>
	</div>
	
</body>
</html>
<script>
	(function(){
		function elPosition(el){           //找到元素屏幕位置
			return el.getBoundingClientRect();
		}

		function posP(el){               //找到最近的定位祖先元素
	   		var parent=el.parentNode;
	   		var str=getComputedStyle(parent).position;
	   		if( str == 'absolute' || str == 'relative' || str == 'fixed'){
	   			return parent;
	   		}else{
	   			return posP(parent);
	   		}
	   }

		function GridNav(eles,btnUp,btnDown,n,m){     //显示网格为n,点击隐藏网格为m
			this.eles=eles;
			this.btnUp=btnUp;
			this.btnDown=btnDown;
			this.n=n;
			this.m=m;
			this.gridMoveY=elPosition(this.eles[0]).width+parseInt(getComputedStyle(this.eles[0]).marginBottom)+parseInt(getComputedStyle(this.eles[0]).marginTop);
			this.holdTopN=0;                         //储存隐藏上面的个数
		}
		GridNav.prototype={
			init:function(){
				this.pos();
				this.btnUp.onclick=this.up.bind(this);
				this.btnDown.onclick=this.down.bind(this);
				Array.prototype.forEach.call(this.eles,function(el){
					el.classList.add('cur');
				})
			},
			pos:function(){
				var scrollTop = document.documentElement.scrollTop || window.pageYOffset || document.body.scrollTop;
				var scrollLeft = document.documentElement.scrollLeft || window.pageXOffset || document.body.scrollLeft;
				var posParent=posP(this.eles[0]);
				var pP=elPosition(posParent);
				for(var i=this.eles.length-1;i>=0;i--){
					var p=elPosition(this.eles[i]);
					if(this.n > i){
						this.eles[i].style.cssText='position:absolute;left:'+(p.left-pP.left)+'px;top:'+(p.top-pP.top)+'px;opacity:1;'
					}else{
						this.eles[i].style.cssText='position:absolute;left:'+(p.left-pP.left)+'px;top:'+this.n/this.m * this.gridMoveY+'px;opacity:0;'
					}
				}
			},
			up:function(){
				this.holdTopN-=this.m;
				if(this.holdTopN<0){
					this.holdTopN+=this.m;
					return;
				}else{
					this.btnUp.onclick=null;
					this.btnDown.onclick=null;
					this.upDateView('up');
				}
			},
			down:function(){
				this.holdTopN+=this.m;
				if(this.holdTopN > this.eles.length-this.n){   //20
					this.holdTopN-=this.m;
					return;
				}else{
					this.btnUp.onclick=null;
					this.btnDown.onclick=null;
					this.upDateView('down');
				}
			},
			upDateView:function(str){
				if(str == 'up'){
					for(var i=this.holdTopN;i<this.holdTopN+this.n+this.m;i++){
						var self=this;
						setTimeout((function(n){
							return function(){
									self.eles[n].style.top=parseInt(self.eles[n].style.top)+self.gridMoveY+'px';
									if(n < self.holdTopN+self.m){
										self.eles[n].style.opacity=1;
									}
									if(n >= self.holdTopN+self.n){
										self.eles[n].style.opacity=0;
									}
									if(n == self.holdTopN ){
										self.btnUp.onclick=self.up.bind(self);
										self.btnDown.onclick=self.down.bind(self);
									}
								};
						})(i), (this.holdTopN-i+this.n+this.m-1)*50)
					}				
				}else if(str == 'down'){
						for(var i=this.holdTopN-this.m;i<this.holdTopN+this.n;i++){
							var self=this;
							setTimeout((function(n){
								return function(){
										self.eles[n].style.top=parseInt(self.eles[n].style.top)-self.gridMoveY+'px';
										if(n < self.holdTopN){
											self.eles[n].style.opacity=0;
										}
										if(n >= self.holdTopN+self.n-self.m){
											self.eles[n].style.opacity=1;
										}
										if(n == self.holdTopN+self.n-1){
											self.btnUp.onclick=self.up.bind(self);
											self.btnDown.onclick=self.down.bind(self);
										}
									};
							})(i), (i-this.holdTopN+this.m)*50)
						}
					}
					this.flag=true;
				}

		}

		var lis=document.getElementById('wrap').getElementsByTagName('li');
		var Up=document.getElementById('up');
		var Down=document.getElementById('down');
		var myGridNav=new GridNav(lis,Up,Down,8,4);
		myGridNav.init();
	})()	
</script>